<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Encomenda de Camisolas - 1024 FC</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background-color: #0d0d0d;
      color: #ffffff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background-color: #006400;
      padding: 20px 0;
    }

    .logo {
      width: 100px;
      height: auto;
      display: block;
      margin: 0 auto 10px;
    }

    h1 {
      margin: 20px 0;
      font-size: 32px;
      text-align: center;
    }

    .navbar {
      background-color: #006400 !important;
    }

    .navbar-brand {
      display: none;
    }

    .nav-link {
      color: #ffffff !important;
      font-weight: bold;
      margin: 0 5px;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px !important;
      border-radius: 4px;
    }

    .nav-link:hover {
      color: #90ee90 !important;
      background-color: rgba(255, 255, 255, 0.1);
    }

    main {
      padding: 40px 20px;
      flex: 1;
    }

    .formulario-container {
      max-width: 800px;
      margin: 0 auto;
      background: #1a1a1a;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 2px 10px rgba(255, 255, 255, 0.05);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      font-weight: bold;
      color: #90ee90;
    }

    .form-control {
      background-color: #2a2a2a;
      border: 1px solid #555;
      color: #fff;
      padding: 10px 15px;
    }

    .form-control:focus {
      background-color: #2a2a2a;
      color: #fff;
      border-color: #90ee90;
      box-shadow: 0 0 0 0.25rem rgba(144, 238, 144, 0.25);
    }

    .separador {
      border-top: 2px solid #006400;
      margin: 30px 0;
      position: relative;
    }

    .separador-texto {
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #1a1a1a;
      padding: 0 15px;
      color: #90ee90;
      font-weight: bold;
    }

    .btn-enviar {
      background-color: #006400;
      color: white;
      border: none;
      padding: 12px 25px;
      font-size: 18px;
      border-radius: 8px;
      margin-top: 30px;
      transition: background-color 0.3s;
      width: 100%;
    }

    .btn-enviar:hover {
      background-color: #228B22;
    }

    .btn-enviar:disabled {
      background-color: #555;
      cursor: not-allowed;
    }

    .mensagem-sucesso {
      text-align: center;
      padding: 30px;
    }

    .mensagem-sucesso h2 {
      color: #90ee90;
      font-size: 28px;
      margin-bottom: 15px;
    }

    .mensagem-sucesso p {
      font-size: 18px;
      color: #ddd;
    }

    .opcoes-camisolas {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-top: 20px;
    }

    @media (max-width: 768px) {
      .opcoes-camisolas {
        grid-template-columns: 1fr;
      }
    }

    .opcao-camisola {
      cursor: pointer;
      transition: transform 0.3s;
      text-align: center;
      position: relative;
    }

    .opcao-camisola:hover {
      transform: scale(1.03);
    }

    .opcao-camisola img {
      width: 100%;
      height: 430px;
      object-fit: cover;
      border-radius: 8px;
      border: 3px solid transparent;
    }

    .opcao-camisola.selected img {
      border-color: #90ee90;
    }

    .opcao-camisola .checkmark {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: #006400;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .opcao-camisola.selected .checkmark {
      opacity: 1;
    }

    .footer-link {
      color: #90ee90;
      text-decoration: none;
      transition: color 0.2s ease;
    }

    .footer-link:hover {
      text-decoration: underline;
      color: #ffffff;
    }

    .footer-logo {
      height: 50px;
      object-fit: contain;
    }

    .invalid-feedback {
      color: #ff6b6b;
    }
  </style>
</head>
<body>

  <header>
    <img src="assets/logo.png" alt="1024 FC Logo" class="logo" onerror="this.style.display='none'">
    <h1>1024 FC</h1>

    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="index.html">
                <i class="fas fa-home"></i> Início
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="plantel.html">
                <i class="fas fa-tshirt"></i> Plantel
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="calendario.html">
                <i class="fas fa-calendar-alt"></i> Calendário
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="loja/index.html">
                <i class="fas fa-shopping-cart"></i> Loja
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="contactos.html">
                <i class="fas fa-envelope"></i> Contacto
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <main>
    <div id="formulario-content">
      <!-- Conteúdo será carregado dinamicamente -->
    </div>
  </main>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.0.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBVWDPxef51zLUecq6mdykHHsjb3-4RipE",
      authDomain: "fc-97e26.firebaseapp.com",
      projectId: "fc-97e26",
      storageBucket: "fc-97e26.appspot.com",
      messagingSenderId: "681974250508",
      appId: "1:681974250508:web:f524ef640cf183f21c8229"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const formularioContent = document.getElementById("formulario-content");

    function loadFormulario() {
      const camisolas = [
        { id: 1, img: "assets/camisolas/principal.png", nome: "Camisola Principal" },
        { id: 2, img: "assets/camisolas/alternativo.png", nome: "Camisola Alternativa" },
        { id: 3, img: "assets/camisolas/verde.png", nome: "Terceira Camisola" },
        { id: 4, img: "assets/camisolas/rosa.png", nome: "Quarta Camisola" }
      ];

      const tamanhos = ["XS", "S", "M", "L", "XL", "2XL", "3XL", "4XL"];

      let selectedCamisolas = [];

      const camisolasHTML = camisolas.map(camisola => `
        <div class="opcao-camisola" data-id="${camisola.id}">
          <img src="${camisola.img}" alt="${camisola.nome}" onerror="this.src='assets/placeholder.jpg'">
          <div class="checkmark"><i class="fas fa-check"></i></div>
          <div class="mt-2">${camisola.nome}</div>
        </div>
      `).join('');

      const tamanhosHTML = tamanhos.map(tamanho => `
        <option value="${tamanho}">${tamanho}</option>
      `).join('');

      formularioContent.innerHTML = `
        <div class="formulario-container">
          <h2 class="text-center mb-4">4.ª Encomenda de Camisolas (Setembro)</h2>
          
          <form id="encomendaForm">
            <div class="form-group">
              <label for="nome" class="form-label">Nome Completo</label>
              <input type="text" class="form-control" id="nome" required>
              <div class="invalid-feedback">Por favor, insira o seu nome.</div>
            </div>
            
            <div class="form-group">
              <label for="telemovel" class="form-label">Número de Telemóvel</label>
              <input type="tel" class="form-control" id="telemovel" required>
              <div class="invalid-feedback">Por favor, insira um número de telemóvel válido.</div>
            </div>
            
            <div class="form-group">
              <label for="zona" class="form-label">Zona/Concelho</label>
              <input type="text" class="form-control" id="zona" required>
              <div class="invalid-feedback">Por favor, indique a sua zona/concelho.</div>
            </div>
            
            <div class="separador">
              <span class="separador-texto">Personalização</span>
            </div>
            
            <div class="form-group">
              <label for="nomeCamisola" class="form-label">Nome na Camisola</label>
              <input type="text" class="form-control" id="nomeCamisola" maxlength="25">
              <div class="invalid-feedback">O nome na camisola não pode exceder 25 caracteres.</div>
            </div>
            
            <div class="form-group">
              <label for="numeroCamisola" class="form-label">Número na Camisola</label>
              <input type="number" class="form-control" id="numeroCamisola" min="1" max="999">
              <div class="invalid-feedback">Por favor, insira um número entre 1 e 999.</div>
            </div>
            
            <div class="form-group">
              <label for="tamanho" class="form-label">Tamanho da Camisola</label>
              <select class="form-control" id="tamanho" required>
                <option value="" selected disabled>Selecione um tamanho</option>
                ${tamanhosHTML}
              </select>
              <div class="invalid-feedback">Por favor, selecione um tamanho.</div>
            </div>
            
            <div class="separador">
              <span class="separador-texto">Modelos de Camisola</span>
            </div>
            
            <div class="form-group">
              <p>Selecione uma ou mais camisolas:</p>
              <div class="opcoes-camisolas">
                ${camisolasHTML}
              </div>
              <input type="hidden" id="camisolasSelecionadas" required>
              <div class="invalid-feedback">Por favor, selecione pelo menos uma camisola.</div>
            </div>
            
            <button type="submit" class="btn-enviar">Enviar Encomenda</button>
          </form>
        </div>
      `;

      // Seleção de camisolas
      document.querySelectorAll('.opcao-camisola').forEach(opcao => {
        opcao.addEventListener('click', function() {
          const camisolaId = this.dataset.id;
          
          if (this.classList.contains('selected')) {
            this.classList.remove('selected');
            selectedCamisolas = selectedCamisolas.filter(id => id !== camisolaId);
          } else {
            this.classList.add('selected');
            selectedCamisolas.push(camisolaId);
          }
          
          // Ordena os IDs e atualiza o campo hidden
          selectedCamisolas.sort();
          document.getElementById('camisolasSelecionadas').value = selectedCamisolas.join(', ');
        });
      });

      // Validação do formulário
      const form = document.getElementById('encomendaForm');
      
      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Validar campos
        let isValid = true;
        const nome = document.getElementById('nome');
        const telemovel = document.getElementById('telemovel');
        const zona = document.getElementById('zona');
        const nomeCamisola = document.getElementById('nomeCamisola');
        const numeroCamisola = document.getElementById('numeroCamisola');
        const tamanho = document.getElementById('tamanho');
        const camisolasSelecionadas = document.getElementById('camisolasSelecionadas');
        
        // Validação básica
        if (!nome.value.trim()) {
          nome.classList.add('is-invalid');
          isValid = false;
        } else {
          nome.classList.remove('is-invalid');
        }
        
        if (!telemovel.value.trim() || !/^\d{9}$/.test(telemovel.value.trim())) {
          telemovel.classList.add('is-invalid');
          isValid = false;
        } else {
          telemovel.classList.remove('is-invalid');
        }
        
        if (!zona.value.trim()) {
          zona.classList.add('is-invalid');
          isValid = false;
        } else {
          zona.classList.remove('is-invalid');
        }
        
        if (nomeCamisola.value.length > 25) {
          nomeCamisola.classList.add('is-invalid');
          isValid = false;
        } else {
          nomeCamisola.classList.remove('is-invalid');
        }
        
        if (numeroCamisola.value && (numeroCamisola.value < 1 || numeroCamisola.value > 999)) {
          numeroCamisola.classList.add('is-invalid');
          isValid = false;
        } else {
          numeroCamisola.classList.remove('is-invalid');
        }
        
        if (!tamanho.value) {
          tamanho.classList.add('is-invalid');
          isValid = false;
        } else {
          tamanho.classList.remove('is-invalid');
        }
        
        if (!selectedCamisolas.length) {
          camisolasSelecionadas.classList.add('is-invalid');
          isValid = false;
        } else {
          camisolasSelecionadas.classList.remove('is-invalid');
        }
        
        if (!isValid) return;
        
        // Desativar botão de envio
        const submitBtn = form.querySelector('button[type="submit"]');
        submitBtn.disabled = true;
        submitBtn.textContent = "A processar...";
        
        try {
          // Enviar para o Firestore
          await addDoc(collection(db, "encomendas_pv"), {
            nome: nome.value.trim(),
            telemovel: telemovel.value.trim(),
            zona: zona.value.trim(),
            nome_camisola: nomeCamisola.value.trim(),
            numero_camisola: numeroCamisola.value ? parseInt(numeroCamisola.value) : null,
            tamanho: tamanho.value,
            camisolas: selectedCamisolas.join(', '),
            timestamp: new Date()
          });
          
          // Mostrar mensagem de sucesso
          formularioContent.innerHTML = `
            <div class="mensagem-sucesso">
              <h2>ENCOMENDA REGISTADA COM SUCESSO!</h2>
              <p>Obrigado pela tua encomenda. Entraremos em contacto brevemente.</p>
              <a href="index.html" class="btn btn-success mt-3">
                <i class="fas fa-home me-2"></i> Voltar à Página Inicial
              </a>
            </div>
          `;
        } catch (error) {
          console.error("Erro ao enviar encomenda:", error);
          alert("Ocorreu um erro ao enviar a tua encomenda. Por favor, tenta novamente.");
          submitBtn.disabled = false;
          submitBtn.textContent = "Enviar Encomenda";
        }
      });
    }

    loadFormulario();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <footer class="footer mt-auto py-4" style="background-color: #0b2e13;">
    <div class="container text-center text-light">
      <p class="mb-1">© 2025 1024 FC. Todos os direitos reservados.</p>
      <p class="mb-3">
        <a href="politica-privacidade.html" class="footer-link">Política de Privacidade</a>
      </p>
      
      <hr class="footer-divider my-3">
  
      <p class="mb-2">Powered by:</p>
      <div class="d-flex justify-content-center align-items-center gap-4 flex-wrap">
        <img src="assets/bwin.png" alt="Logo 1" class="footer-logo">
        <img src="assets/kilt.png" alt="Logo 2" class="footer-logo">
        <img src="assets/FL.png" alt="Logo 3" class="footer-logo">
      </div>
    </div>
  </footer>

</body>
</html>